<div class="text-center" *ngIf="!userdata">
    <div class="spinner-border text-primary"></div>
</div>

<div *ngIf="userdata">
    <div class="mb-5 text-center" *ngIf="edit">
        <ng-container *ngIf="saving">
            <div class="spinner-border spinner-border-sm text-success mr-2"></div>
            <span class="text-success">Wird gespeichert...</span>
        </ng-container>

        <ng-container *ngIf="!saving">
            <i class="fas fa-tick"></i>
            <span class="text-success">Erfolgreich gespeichert!</span>
        </ng-container>
    </div>

    <table class="table table-hover" [class.editMode]="edit" [class.small]="small">
        <thead>
            <tr>
                <th>{{small ? "" : "Mein Stundenplan"}}</th>
                <th *ngFor="let day of days">{{small ? day.nameShort : day.name}}</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of getRows()" [class.isBreak]="isBreak(row)" [class.isLaunchBreak]="isLaunchBreak(row)">
                <td>{{small ? row[0].nameShort : row[0].name}}</td>
                <td *ngFor="let period of row" [class]="isFree(period) ? 'free' : 'lesson'" (click)="select(period)" [class.selected]="selectedDay == period.dayId && selectedPeriod == period.id"></td>
            </tr>
        </tbody>
    </table>


    <div *ngIf="selectedDay && selectedPeriod">
        <div *ngIf="!usersToShow || usersToShow.length === 0">
            Keine Personen haben dort eine Freistunde!
        </div>
        <div *ngIf="usersToShow && usersToShow.length > 0">
            <button class="btn btn-outline-primary" (click)="showSchedules = !showSchedules">{{showSchedules ? "Stundenpläne verbergen" : "Stundenpläne anzeigen"}}</button>
            <div class="card-deck mt-4">
                <div class="card p-3" *ngFor="let user of usersToShow">
                    <p class="text-center mt-1">{{ user.username }}</p>
                    <app-schedule *ngIf="showSchedules" [userdata]="user.data" [small]="true"></app-schedule>
                </div>
            </div>
        </div>
    </div>
</div>